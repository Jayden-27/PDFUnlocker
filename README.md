# PDF密码移除工具

一个简单易用的 PDF 密码移除工具，支持批量处理，使用图形化界面操作。

## 📋 功能特性

- ✅ **批量处理** - 支持同时选择多个 PDF 文件
- 🔐 **密码移除** - 使用已知密码打开 PDF 并保存为无密码版本
- 💾 **灵活保存** - 支持覆盖源文件或另存到新位置
- 📊 **实时进度** - 进度条显示处理状态，详细日志反馈
- 🎨 **友好界面** - 基于 tkinter 的现代化图形界面
- ⚡ **多线程** - 后台处理不阻塞界面响应
- 🛡️ **安全提示** - 覆盖文件前二次确认

## 🖼️ 界面预览

程序界面包含：
- 文件列表管理（添加、移除、清空）
- 密码输入（支持显示/隐藏）
- 保存选项（覆盖/另存）
- 实时进度显示
- 彩色日志输出（成功/失败/处理中）

## 🚀 快速开始

### 方法一：直接运行 EXE（推荐）

1. 下载 `dist/PDFUnlocker.exe`
2. 双击运行即可使用
3. **无需安装** Python 或任何依赖

### 方法二：从源码运行

#### 环境要求

- Python 3.7+
- tkinter（Python 内置）
- pikepdf

#### 安装依赖

```bash
pip install pikepdf
```

#### 运行程序

```bash
python pdf_unlocker_gui.py
```

## 📖 使用说明

### 基本流程

1. **添加文件**
   - 点击"添加文件"按钮选择 PDF 文件
   - 支持多选（Ctrl/Shift + 点击）
   - 可重复添加，自动去重

2. **输入密码**
   - 在"PDF密码"输入框输入文件的已知密码
   - 勾选"显示密码"可查看输入内容
   - 所有文件使用相同密码

3. **选择保存方式**
   
   **覆盖源文件模式**：
   - 选择"覆盖源文件"
   - 原文件将被替换为无密码版本
   - 处理前会二次确认
   
   **另存为模式**：
   - 选择"另存到新位置"
   - 点击"选择目录"指定输出位置
   - 文件命名选项：
     - **原名**：保持原文件名
     - **添加后缀**：在文件名后添加 `_unlocked`

4. **开始处理**
   - 点击"开始处理"按钮
   - 查看实时进度和日志
   - 等待所有文件处理完成

### 处理结果

- ✓ **绿色** - 成功移除密码
- ✗ **红色** - 处理失败（密码错误、文件损坏等）
- ⧗ **蓝色** - 正在处理中

## 🛠️ 从源码打包

如需自行打包为 EXE 文件：

### 安装 PyInstaller

```bash
pip install pyinstaller
```

### 打包命令

```bash
# 打包为单个 EXE 文件（无控制台窗口）
pyinstaller --onefile --windowed --name PDFUnlocker pdf_unlocker_gui.py

# 添加自定义图标（可选）
pyinstaller --onefile --windowed --icon=icon.ico --name PDFUnlocker pdf_unlocker_gui.py
```

### 打包结果

- **可执行文件**：`dist/PDFUnlocker.exe`
- **配置文件**：`PDFUnlocker.spec`（可编辑后重新打包）
- **构建目录**：`build/`（可删除）

## 📦 技术栈

- **GUI 框架**：tkinter
- **PDF 处理**：pikepdf（基于 QPDF）
- **多线程**：threading
- **打包工具**：PyInstaller

## ⚠️ 注意事项

1. **合法使用**
   - 本工具仅用于移除**已知密码**的 PDF 文件保护
   - 请勿用于破解他人加密文件
   - 使用者需对文件拥有合法权限

2. **数据安全**
   - 覆盖模式会永久替换原文件
   - 建议重要文件先备份
   - 批量处理前建议先测试单个文件

3. **密码要求**
   - 所有待处理文件必须使用相同密码
   - 密码错误会跳过该文件并继续处理下一个

4. **文件限制**
   - 仅支持标准 PDF 格式
   - 损坏的 PDF 文件可能无法处理

## 🐛 常见问题

### 提示"未安装 pikepdf 库"？

```bash
pip install pikepdf
```

### 打包后 EXE 文件太大？

这是正常现象，因为包含了：
- Python 解释器
- tkinter 库
- pikepdf 及其依赖（QPDF、lxml 等）
- 总大小约 80-100MB

### 密码正确但提示"密码错误"？

可能原因：
- PDF 有多层加密
- 文件已损坏
- 特殊字符编码问题

### 覆盖模式失败？

检查：
- 文件是否被其他程序占用
- 是否有写入权限
- 磁盘空间是否充足

## 📝 更新日志

### v1.0.0 (2026-02-12)

- ✨ 初始版本发布
- 🎨 图形化界面
- 📦 批量处理支持
- 💾 覆盖/另存双模式
- 📊 实时进度显示
- 🔒 安全提示功能

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📧 联系方式

如有问题或建议，欢迎反馈。

---

**免责声明**：本工具仅供学习交流使用，使用者需遵守相关法律法规，对使用本工具产生的任何后果自行负责。
